---
title: Usage
---

import CloudBanner from "/snippets/cloud-banner.mdx";

This section provides instructions on how to initialize the WalletKit client, approve sessions with supported namespaces, and respond to session requests, enabling easy integration of Web3 wallets with dapps through a simple and intuitive interface.

## Content

Links to sections on this page. Some sections are platform-specific and are only visible when the platform is selected. To view a summary of useful platform-specific topics, check out **Extra (Platform Specific)** under this section.

**[Initialization](#initialization)**: Creating a new ReownWalletKit instance and initializing it with a projectId from [Cloud](https://cloud.reown.com).

**Session**: Connection between a dapp and a wallet.

- [Namespace Builder](#namespace-builder):
  Namespace Builder is a helper utility that greatly reduces the complexity of parsing the required and optional namespaces. It accepts as parameters a session proposal along with your user's chains/methods/events/accounts and returns a ready-to-use object.
- [Session Approval](#session-approval):
  Approving a session sent from a dapp.
- [Session Rejection](#session-rejection):
  Rejecting a session sent from a dapp.
- [Responding to Session Requests](#responding-to-session-requests):
  Responding to session requests sent from a dapp.
- [Updating a Session](#updating-a-session):
  Updating a session sent between a dapp and a wallet.
- [Extending a Session](#extending-a-session):
  Extending a session between a dapp and a wallet.
- [Session Disconnect](#session-disconnect):
  Disconnecting a session between a dapp and a wallet.
- [Formatted Errors](#formatted-errors):
  A list of useful error objects to be used.

<CloudBanner />

## Initialization

To create an instance of ReownWalletKit, you need to pass in the `core` and `metadata` parameters.

...

### Namespace Builder

On Flutter, you don't need to worry about the Namespace Builder, as the Flutter SDK will handle that for you and generate a namespace object with the supported ones for you to approve.

All you have to do is make sure you register...

1. **wallet accounts** with `_walletKit.registerAccount()` for accounts you want events and methods to be enabled on. This is essential if you want to properly form a session object between your wallet and the requester dapp.
2. **request handlers** with `_walletKit.registerRequestHandler()` for methods you want to support on your wallet. Optional but **highly recommended** if you want to seamlessly create a session object, as we will see in the coming section.
3. **event emitters** with `_walletKit.registerEventEmitter()` for events you want to support on your wallet. Optional but recommended if you plan to send events such as `chainChanged` and `accountsChanged`.

...

When a dapp proposes a session with declared namespaces, your wallet will be able to approve an **already generated set of namespaces** based on your registered accounts, methods, and events.

You can access this object in **SessionProposalEvent** during the `onSessionProposal` event by querying `event.params.generatedNamespaces`. (See [Session Approval](#session-approval) below)

<Note>
You can choose **not to use** `registerRequestHandler` to configure your supported methods and instead define them during session approval (See [Session Approval](#session-approval) below).

By not using `registerRequestHandler`, your method requests will be sent through the `onSessionRequest` event subscription.

If you do choose to use `registerRequestHandler` **(highly recommended)**, then the `onSessionRequest` event subscription will not be called.
</Note>

...

### Session Approval

As mentioned before, the `SessionProposalEvent` is emitted when a dapp initiates a new session with your wallet. The event object will include information about the dapp and requested namespaces. The wallet should display a prompt for the user to approve or reject the session.

...

<Note>
As mentioned before, `namespaces:` should be either `event.params.generatedNamespaces!` if you decided to use the `registerRequestHandler` method to configure your supported methods, or a `Map<String, Namespace>` object defined by yourself if you decided **not** to use the `registerRequestHandler` method.
</Note>

#### Pairing

The `pair` method initiates a pairing process with a dapp using the given `uri` (QR code from the dapps). To learn more about pairing, check out the [docs](https://specs.walletconnect.com/2.0/specs/clients/core/pairing/).

...

### Session Rejection

To reject the request, pass in an error code and reason according to [protocol specs](https://specs.walletconnect.com/2.0/specs/clients/sign/error-codes). See also the [Formatted Errors](#formatted-errors) section.

...

### Responding to Session Requests

To handle a session request, such as `personal_sign`, you have two ways as explained before, and they are mutually exclusive. So, either you use the `onSessionRequest` event subscription or your method handlers configured with `registerRequestHandler`.

1. The **recommended** way is to register a request handler for the methods and chains you want to support. So let's say your wallet supports `eip155:1` and `eip155:137`. This would translate to:

...

2. The other way is subscribing to `onSessionRequest` events (if you didn't use the `generatedNamespaces` object) and handling the request based on the method that is firing the event.

...

<Info>
Remember that if you have handlers registered, these will be triggered **instead of** the `onSessionRequest` event.
</Info>

### Updating a Session

If you wish to include new accounts, chains, or methods in an existing session, `updateSession` allows you to do so.  
You need to pass in the `topic` and a new `Namespaces` object that contains all of the existing namespaces as well as the new data you wish to include.

...

### Extending a Session

To extend the session, call the `extendSession` method and pass in the new `topic`. The `SessionUpdate` event will be emitted from the wallet.

...

### Session Disconnect

...

When either the dapp or the wallet disconnects from a session, a `SessionDelete` event will be emitted. It's important to subscribe to this event so you can keep your state up to date.

...

Using `disconnectSession()` alone will make the pairing topic persist, i.e., it can be reused until it expires. If you want to disconnect (remove) the pairing topic as well, you would have to add another call as follows:

...

#### Supporting Session Events

In order to support session events, such as `chainChanged` or `accountChanged`, you must register an event emitter for such events, for every chain you want to emit an event for (similar to request handlers).

...

And to emit an event, call `emitSessionEvent()` as follows:

...

For a better understanding, please check out the [example wallet](https://github.com/reown-com/reown_flutter/tree/master/packages/reown_walletkit/example/lib), and in particular, the [EVMService](https://github.com/reown-com/reown_flutter/blob/master/packages/reown_walletkit/example/lib/dependencies/chain_services/evm_service.dart) inside of it.

### Formatted Errors

Our SDK exports a variety of ready-made error objects for you to use in different situations. The most commonly used are:

...

// When the request coming to your wallet cannot be unparsed  
...

// When a dapp requests an unsupported method from your wallet  
...

But you can check the full list of [available errors here](https://github.com/reown-com/reown_flutter/blob/master/packages/reown_core/lib/utils/errors.dart)

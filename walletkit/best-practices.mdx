---
sidebarTitle: Best Practices
title: Best Practices for Wallets
summary: Guidelines for wallet providers to optimize user experience with Reown's WalletKit
keywords: wallets, best practices, pairing, session management, errors, latency
version: 2.0
---

# WalletKit Overview

WalletKit is Reown's official SDK that enables wallets to connect securely with decentralized applications (DApps). It handles critical functions including:

- **Pairing** - Creating secure connections between wallets and DApps
- **Session Management** - Handling proposal, approval, rejection, and termination of sessions
- **WebSocket Connection** - Maintaining stable connection with the relay network
- **Error Handling** - Processing and communicating errors between components

This document outlines best practices for implementing WalletKit in your wallet to ensure optimal user experience.

## Quick Start

Initialize WalletKit as early as possible in your application lifecycle:

<Tabs>
  <Tab title="Web">
```javascript
// Initialize WalletKit in your app entry point
import { WalletKit } from '@reown/walletkit';

const walletKit = await WalletKit.init({
  projectId: 'YOUR_PROJECT_ID',
  name: 'Your Wallet Name'
});
```
  </Tab>
  <Tab title="React Native">
```javascript
// Initialize WalletKit in your app entry point
import { WalletKit } from '@reown/walletkit-react-native';

const walletKit = await WalletKit.init({
  projectId: 'YOUR_PROJECT_ID',
  name: 'Your Wallet Name'
});
```
  </Tab>
  <Tab title="iOS">
```swift
// Initialize WalletKit in your AppDelegate
import WalletKit

func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {
    WalletKit.configure(with: WalletKitConfig(
        projectId: "YOUR_PROJECT_ID",
        name: "Your Wallet Name"
    ))
    return true
}
```
  </Tab>
  <Tab title="Android">
```kotlin
// Initialize WalletKit in your Application class
import io.reown.walletkit.WalletKit

class YourApplication : Application() {
    override fun onCreate() {
        super.onCreate()
        WalletKit.initialize(
            context = this,
            projectId = "YOUR_PROJECT_ID", 
            name = "Your Wallet Name"
        )
    }
}
```
  </Tab>
</Tabs>

## Checklist Before Going Live

To ensure your wallet adheres to best practices, implement the following before deployment:

| Category | Best Practice | Priority |
|----------|---------------|----------|
| **User Feedback** | Display clear connection/transaction status messages | High |
| | Show loading indicators during operations | High |
| | Communicate errors to both user and DApp | High |
| **Mobile Experience** | Implement deep linking between wallet and DApp | High |
| | Ensure proper redirection after transactions | Medium |
| **Performance** | Connection time < 5s (normal conditions) | High |
| | Connection time < 15s (poor network) | Medium |
| | Transaction signing < 5s (normal conditions) | High |
| | Transaction signing < 10s (poor network) | Medium |
| **Security** | Implement Verify API with all four states | High |
| **Maintenance** | Use latest SDK version | High |
| | Subscribe to SDK update notifications | Medium |

## 1. User Feedback and Messaging

### Context
Users often face ambiguity determining whether their connection or transactions were successful. Clear messaging reduces anxiety and improves user experience.

### Best Practices
- ✅ Display clear success and error messages for all user interactions
- ✅ Provide loading indicators during connection and transaction processing
- ✅ Include status indicators for internet availability
- ✅ Return errors to the DApp (not just the user) to allow proper state management

<Frame caption="An example of a successful connection message in a Rainbow wallet">
![](/images/assets/connection-successful.png)
</Frame>

## 2. Pairing Implementation

### Pairing Overview

**What is Pairing?** A pairing is a secure connection between a wallet and a DApp with fixed permissions that allows the DApp to propose sessions. Each pairing can support multiple sessions.

### Pairing Process

<Tabs>
  <Tab title="Web" >
```jsx
const uri = 'wc:a13aef...'; // pairing URI received from DApp (typically via QR code)
try {
    // Initiate pairing with the DApp
    await walletKit.pair({ uri });
    // Display success message to user
} catch (error) {
    // Handle and display specific error (see Expected Errors section)
    console.error('Pairing failed:', error);
}
```
</Tab>
<Tab title="React Native">
```jsx
const uri = 'wc:a13aef...'; // pairing URI received from DApp (typically via QR code)
try {
    // Initiate pairing with the DApp
    await walletKit.pair({ uri });
    // Display success message to user
} catch (error) {
    // Handle and display specific error (see Expected Errors section)
    console.error('Pairing failed:', error);
}
```
</Tab>
<Tab title="iOS">
```swift
// Convert string URI to WalletConnectURI object
let uri = WalletConnectURI(string: urlString)

if let uri {
    Task {
        do {
            // Initiate pairing with the DApp
            try await WalletKit.instance.pair(uri: uri)
            // Display success message to user
        } catch {
            // Handle and display specific error
            print("Pairing failed: \(error)")
        }
    }
}
````
</Tab>
<Tab title="Android">
```kotlin
val pairingParams = Wallet.Params.Pair(pairingUri)
WalletKit.pair(pairingParams,
    onSuccess = {
        // Pairing successful - wallet should now await session proposal
        // Display success message to user
    },
    onError = { error ->
        // Handle and display specific error (see Expected Errors section)
        Log.e("WalletKit", "Pairing failed: $error")
    }
}
````
</Tab>
</Tabs>

### Pairing State Management

#### Pairing Expiry
Inactive pairings expire after 5 minutes, while active pairings (with approved sessions) expire after 30 days. Monitor these events to update your UI accordingly.

<Tabs>
  <Tab title="Web" >
```typescript
// Subscribe to pairing expiry events
core.pairing.events.on("pairing_expire", (event) => {
    const { topic } = event; // The topic identifies which pairing expired
    
    // Update UI to inform user the connection has expired
    // E.g., remove the pairing from active connections list
});
```
  </Tab>
  <Tab title="React Native">
```typescript
// Subscribe to pairing expiry events
core.pairing.events.on("pairing_expire", (event) => {
    const { topic } = event; // The topic identifies which pairing expired
    
    // Update UI to inform user the connection has expired
    // E.g., remove the pairing from active connections list
});
```
  </Tab>
  <Tab title="iOS">
```Swift
// Subscribe to pairing expiry events
WalletKit.instance.pairingExpirationPublisher
    .receive(on: DispatchQueue.main)
    .sink { pairing in
        guard !pairing.active else { return }
        // Inform user that pairing has expired
        // E.g., show alert or update connection status
    }.store(in: &publishers)
```
  </Tab>
  <Tab title="Android" label="Android">
```kotlin
val coreDelegate = object : CoreClient.CoreDelegate {
    override fun onPairingExpired(expiredPairing: Core.Model.ExpiredPairing) {
        // Handle pairing expiry event
        // Update UI to inform user
    }
    // ...other required callbacks
}

// Set the delegate to receive events
CoreClient.setDelegate(coreDelegate)
````
</Tab>
</Tabs>

### Expected Pairing Errors

| Error Type | Description | User Action | DApp Action |
|------------|-------------|-------------|-------------|
| No Internet | Connection attempt with no network | Retry with active connection | Display error, allow retry |
| Expired Pairing | QR code/URI has expired | Refresh QR code and scan again | Generate new pairing URI |
| Duplicate Pairing | Attempt to pair with existing pairing | Generate new pairing | Generate new pairing URI |
| Invalid URI | Malformed or corrupt pairing URI | Get new URI from DApp | Generate new pairing URI |

## 3. Session Proposal Handling

### What is a Session Proposal?
A session proposal is a handshake sent by a DApp that defines the rules and permissions for the connection. The wallet must approve or reject this proposal to establish a session.

### Sample Session Proposal Object
```javascript
{
  id: '1234567890',
  params: {
    proposer: {
      publicKey: '0x...',
      metadata: {
        name: 'Example DApp',
        description: 'A DApp for testing WalletKit',
        url: 'https://example.com',
        icons: ['https://example.com/icon.png']
      }
    },
    requiredNamespaces: {
      eip155: {
        chains: ['eip155:1'],
        methods: ['eth_sendTransaction', 'personal_sign'],
        events: ['accountsChanged', 'chainChanged']
      }
    }
  }
}
```

### Approving a Session

<Tabs>
  <Tab title="Web" >
```typescript
try {
    // Show loading indicator when user taps "Approve"
    showLoadingIndicator();
    
    // Approve the session with selected accounts and chains
    await walletKit.approveSession({
      id: proposal.id,
      namespaces: {
        eip155: {
          accounts: ['eip155:1:0x...'], // Format: chainId:accountAddress
          methods: proposal.requiredNamespaces.eip155.methods,
          events: proposal.requiredNamespaces.eip155.events
        }
      }
    });
    
    // Hide loading indicator, show success message
    hideLoadingIndicator();
    showSuccessMessage('Connection approved');
} catch (error) {
    // Hide loading indicator, show error message
    hideLoadingIndicator();
    showErrorMessage(`Connection failed: ${error.message}`);
}
````
  </Tab>
  <Tab title="React Native">
```typescript
try {
    // Show loading indicator when user taps "Approve"
    showLoadingIndicator();
    
    // Approve the session with selected accounts and chains
    await walletKit.approveSession({
      id: proposal.id,
      namespaces: {
        eip155: {
          accounts: ['eip155:1:0x...'], // Format: chainId:accountAddress
          methods: proposal.requiredNamespaces.eip155.methods,
          events: proposal.requiredNamespaces.eip155.events
        }
      }
    });
    
    // Hide loading indicator, show success message
    hideLoadingIndicator();
    showSuccessMessage('Connection approved');
} catch (error) {
    // Hide loading indicator, show error message
    hideLoadingIndicator();
    showErrorMessage(`Connection failed: ${error.message}`);
}
```
  </Tab>
  <Tab title="iOS">
```swift
do {
    // Show loading indicator when user taps "Approve"
    showLoadingIndicator()
    
    // Approve the session with selected accounts and chains
    try await WalletKit.instance.approve(
        proposalId: proposal.id,
        namespaces: sessionNamespaces,
        sessionProperties: proposal.sessionProperties
    )
    
    // Hide loading indicator, show success message
    hideLoadingIndicator()
    showSuccessMessage("Connection approved")
} catch {
    // Hide loading indicator, show error message
    hideLoadingIndicator()
    showErrorMessage("Connection failed: \(error.localizedDescription)")
}
```
  </Tab>
  <Tab title="Android" label="Android">
```kotlin
// Create approval parameters with selected accounts and chains
val approveProposal = Wallet.Params.ApproveSession(
    proposalId = proposal.id,
    namespaces = namespaces // Map of namespace configurations
)

// Show loading indicator when user taps "Approve"
showLoadingIndicator()

WalletKit.approveSession(approveProposal,
  onSuccess = {
    // Hide loading indicator, show success message
    hideLoadingIndicator()
    showSuccessMessage("Connection approved")
  },
  onError = { error ->
    // Hide loading indicator, show error message
    hideLoadingIndicator()
    showErrorMessage("Connection failed: ${error.message}")
  })
```
</Tab>
</Tabs>

### Rejecting a Session

<Tabs>
  <Tab title="Web" >
```typescript
try {
    // Show loading indicator when user taps "Reject"
    showLoadingIndicator();
    
    // Reject the session with reason
    await walletKit.rejectSession({
      id: proposal.id,
      reason: {
        code: 4001,
        message: 'User rejected the request'
      }
    });
    
    // Hide loading indicator, show success message
    hideLoadingIndicator();
    showMessage('Connection rejected');
} catch (error) {
    // Hide loading indicator, show error message
    hideLoadingIndicator();
    showErrorMessage(`Error: ${error.message}`);
}
```
  </Tab>
  <Tab title="React Native">
```typescript
try {
    // Show loading indicator when user taps "Reject"
    showLoadingIndicator();
    
    // Reject the session with reason
    await walletKit.rejectSession({
      id: proposal.id,
      reason: {
        code: 4001,
        message: 'User rejected the request'
      }
    });
    
    // Hide loading indicator, show success message
    hideLoadingIndicator();
    showMessage('Connection rejected');
} catch (error) {
    // Hide loading indicator, show error message
    hideLoadingIndicator();
    showErrorMessage(`Error: ${error.message}`);
}
```
  </Tab>
  <Tab title="iOS">
```swift
do {
    // Show loading indicator when user taps "Reject"
    showLoadingIndicator()
    
    // Reject the session with reason
    try await WalletKit.instance.reject(
        proposalId: proposal.id,
        reason: .userRejected
    )
    
    // Hide loading indicator, show success message
    hideLoadingIndicator()
    showMessage("Connection rejected")
} catch {
    // Hide loading indicator, show error message
    hideLoadingIndicator()
    showErrorMessage("Error: \(error.localizedDescription)")
}
```
  </Tab>
  <Tab title="Android" label="Android">
```kotlin
// Create rejection parameters
val rejectParams = Wallet.Params.RejectSession(
    proposalId = proposal.id,
    reason = SessionRejectionReason.USER_REJECTED
)

// Show loading indicator when user taps "Reject"
showLoadingIndicator()

WalletKit.rejectSession(rejectParams,
  onSuccess = {
    // Hide loading indicator, show success message
    hideLoadingIndicator()
    showMessage("Connection rejected")
  },
  onError = { error ->
    // Hide loading indicator, show error message
    hideLoadingIndicator()
    showErrorMessage("Error: ${error.message}")
  })
```
</Tab>
</Tabs>

## 4. Mobile Linking

### What is Mobile Linking?
Mobile linking allows seamless transitions between DApps and wallets on mobile devices, ensuring users can complete actions without manually switching applications.

### Deep Links vs Universal Links
**Deep links** (e.g., `yourwallet://`) provide a more reliable user experience than universal links. Deep links:
- Launch the target app directly
- Support passing parameters in the URL
- Work consistently across platforms

### Implementing Mobile Linking

<Tabs>
  <Tab title="iOS">
```swift
// In your AppDelegate or SceneDelegate
func application(_ app: UIApplication, open url: URL, options: [UIApplication.OpenURLOptionsKey: Any] = [:]) -> Bool {
    // Check if URL is a WalletKit deep link
    if WalletKit.instance.isWalletConnectDeepLink(url) {
        // Handle WalletConnect URL
        Task {
            do {
                try await WalletKit.instance.handleDeepLink(url)
                return true
            } catch {
                // Handle error
                print("Deep link error: \(error)")
                return false
            }
        }
    }
    return false
}
```
  </Tab>
  <Tab title="Android">
```kotlin
// In your Activity
override fun onCreate(savedInstanceState: Bundle?) {
    super.onCreate(savedInstanceState)
    // Check if app was opened from a deep link
    intent?.data?.let { uri ->
        if (WalletKit.isWalletConnectDeepLink(uri)) {
            WalletKit.handleDeepLink(uri,
                onSuccess = {
                    // Deep link processed successfully
                },
                onError = { error ->
                    // Handle error
                    Log.e("DeepLink", "Error: ${error.message}")
                }
            )
        }
    }
}
```
  </Tab>
</Tabs>

### Redirecting Back to DApp
After completing an action, ensure your wallet redirects the user back to the DApp:

<Tabs>
  <Tab title="iOS">
```swift
// After session approval or transaction signing
func redirectBackToDApp(using redirectUrl: String?) {
    guard let redirectUrl = redirectUrl,
          let url = URL(string: redirectUrl) else { return }
    
    DispatchQueue.main.async {
        UIApplication.shared.open(url)
    }
}
```
  </Tab>
  <Tab title="Android">
```kotlin
// After session approval or transaction signing
fun redirectBackToDApp(redirectUrl: String?) {
    redirectUrl?.let { urlString ->
        try {
            val intent = Intent(Intent.ACTION_VIEW, Uri.parse(urlString))
            intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)
            startActivity(intent)
        } catch (e: Exception) {
            Log.e("Redirect", "Failed to redirect: ${e.message}")
        }
    }
}
```
  </Tab>
</Tabs>

## 5. Testing WalletKit Features

### Test Scenarios

| Feature | Test Scenario | Expected Outcome |
|---------|--------------|------------------|
| Pairing | Scan QR with no internet | Error message shown + retry option |
| | Scan expired QR code | Error with refresh suggestion |
| | Scan valid QR code | Successful pairing, proposal shown |
| Session Proposal | Approve with selected accounts | Success message, session active |
| | Reject proposal | Success message, back to home screen |
| | App killed during approval | Proper error handling when reopened |
| Mobile Linking | Open deep link from DApp | Wallet opens with correct context |
| | Complete action in wallet | Redirects back to DApp |
| Performance | Measure connection time | < 5s in normal conditions |
| | Measure signing time | < 5s in normal conditions |
| Multiple Connections | Connect to multiple DApps | All connections work independently |
| WebSocket Connection | Turn off Wi-Fi during session | Reconnection attempt + user notification |

## 6. Troubleshooting

### Common Issues

| Issue | Possible Causes | Solution |
|-------|----------------|----------|
| Session proposal not received | Network issues, pairing expired | Check network, refresh QR code |
| Cannot approve session | Invalid namespace configuration | Ensure accounts match required chains |
| Slow connection | Poor network, obsolete SDK | Check network, update SDK |
| Deep link not working | Improper URL scheme registration | Verify URL scheme in app manifest/Info.plist |
| Session disconnects frequently | Background process limitations | Implement proper reconnection logic |

### Debugging Tools

- **WalletKit Logs**: Enable debug logs to trace issues
  ```typescript
  WalletKit.init({
    // other options...
    logger: 'debug'  // Options: 'error', 'warn', 'info', 'debug'
  })
  ```

- **Network Inspector**: Use browser developer tools or Charles Proxy to inspect network traffic
- **Test DApp**: Use our [test DApp](https://test.reown.com) to verify your wallet's compliance with best practices

## Version Information
- **Current WalletKit Version**: 2.0
- **Release Date**: 2023-10-15
- [View Changelog](https://docs.reown.com/walletkit/changelog)
- [GitHub Repository](https://github.com/reown/walletkit)
